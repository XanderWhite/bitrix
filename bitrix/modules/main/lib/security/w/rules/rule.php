<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____980256523']= array(base64_decode('aXNfc'.'3'.'R'.'y'.'aW5n'),base64_decode(''.'c3RydG9sb3dl'.'cg=='),base64_decode('aXNfY'.'X'.'JyYXk='),base64_decode(''.'aXN'.'fc3R'.'yaW5n'),base64_decode('Z'.'3pk'.'Z'.'WNvZG'.'U='),base64_decode('YmFzZTY0'.'X'.'2RlY29kZQ='.'='),base64_decode('dXJsZGVjb'.'2Rl'),base64_decode('Y'.'X'.'JyYX'.'l'.'f'.'cmV2Z'.'X'.'JzZQ=='),base64_decode('Z3p'.'lbm'.'NvZGU'.'='),base64_decode('YmFzZTY0X2V'.'uY'.'29'.'k'.'ZQ=='),base64_decode('dXJs'.'ZW5j'.'b2Rl'),base64_decode('YmluMmh'.'leA=='),base64_decode('aXNf'.'Y'.'XJyY'.'Xk='),base64_decode('c'.'3R'.'ydG9'.'sb3dlcg=='),base64_decode('aXN'.'fYXJ'.'yYXk='),base64_decode(''.'am9pbg'.'=='),base64_decode('Zm5tYXR'.'j'.'aA=='),base64_decode('cmF3dXJsZGVjb'.'2Rl'),base64_decode('c3Vic3Ry'),base64_decode('c3V'.'i'.'c3Ry'),base64_decode('c3'.'RyX3JlcGxh'.'Y'.'2U='),base64_decode('cHJlZ1'.'9x'.'dW90'.'ZQ=='),base64_decode('cH'.'JlZ19tYXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___840363322')){function ___840363322($_320204545){static $_1226262278= false; if($_1226262278 == false) $_1226262278=array('YWN0a'.'W9u','a'.'W50dm'.'Fs',''.'cGF0aA==','Y2'.'9udGV4dA'.'==',''.'a2V5cw==','cHJvY2Vzcw==','ZW5jb'.'2Rp'.'bm'.'c=','cHJlZ'.'19yZXB'.'sYWN'.'l',''.'cG'.'F'.'0a'.'A='.'=',''.'Y29udGV'.'4dA==','a2V5cw==','cHJvY2V'.'z'.'cw==','ZW5j'.'b2Rpbmc=','cGF0dGV'.'y'.'bg==',''.'cHJlZ19'.'t'.'YXR'.'jaA==','cG'.'F0aA='.'=',''.'Y29udGV4dA'.'==',''.'a2V5cw==','cHJvY2'.'Vz'.'cw==','ZW5jb2'.'R'.'pb'.'mc'.'=','c'.'G'.'F'.'0'.'dG'.'Vybg==','cG9zdF9hY'.'3Rpb24'.'=','Y2hlY2tfY'.'3N'.'yZg='.'=','cGF0aA'.'==','Y'.'29ud'.'GV4dA='.'=','a2V5cw==','c'.'HJvY2Vzcw==','ZW5jb2Rpbmc=',''.'c'.'GF0dGV'.'yb'.'g==','YWN'.'0a'.'W9u','Y'.'WN'.'0'.'aW9'.'u','YWN'.'0aW9u','YWN0aW9u','YWN0aW9u',''.'YWN0aW9u','cG9zdF9h'.'Y'.'3R'.'pb24=','ZW5jb2Rpbmc=','ZW5'.'j'.'b2Rp'.'b'.'mc=','ZW5j'.'b2Rpbmc=','ZW5j'.'b2'.'Rpbmc=',''.'ZW5'.'jb2Rpb'.'mc=','ZW5'.'jb2Rpb'.'mc=','Z'.'3o'.'=','YmFzZTY0',''.'d'.'XJs','aGV4','L'.'g='.'=','Lw==','aW5kZX'.'gu'.'cG'.'hw',''.'L'.'2luZGV4LnBocA==','U0NSSVBUX05BTUU=','L2'.'lu'.'ZGV4Ln'.'Boc'.'A==',''.'U0NSS'.'VB'.'U'.'X0'.'5BT'.'U'.'U'.'=',''.'U0NSSVBUX0'.'5BT'.'UU=','U'.'0NSSVB'.'U'.'X05BT'.'UU=','fg==','f'.'l'.'4=','fg='.'=',''.'XH4=','JH4=');return base64_decode($_1226262278[$_320204545]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_130713278; protected $_1087855165; protected $_1288687307; protected $_430530972; protected $_1745579287; public static function make(array $_2060132938):?static{ $_2060132938= static::prepareRuleParameters($_2060132938); return match($_2060132938[___840363322(0)]){ ___840363322(1) => new IntvalRule( $_2060132938[___840363322(2)], $_2060132938[___840363322(3)], $_2060132938[___840363322(4)], $_2060132938[___840363322(5)], $_2060132938[___840363322(6)]), ___840363322(7) => new PregReplaceRule( $_2060132938[___840363322(8)], $_2060132938[___840363322(9)], $_2060132938[___840363322(10)], $_2060132938[___840363322(11)], $_2060132938[___840363322(12)], $_2060132938[___840363322(13)]), ___840363322(14) => new PregMatchRule( $_2060132938[___840363322(15)], $_2060132938[___840363322(16)], $_2060132938[___840363322(17)], $_2060132938[___840363322(18)], $_2060132938[___840363322(19)], $_2060132938[___840363322(20)], $_2060132938[___840363322(21)]), ___840363322(22) => new CsrfRule( $_2060132938[___840363322(23)], $_2060132938[___840363322(24)], $_2060132938[___840363322(25)], $_2060132938[___840363322(26)], $_2060132938[___840363322(27)], $_2060132938[___840363322(28)],), default => null,};} protected static function prepareRuleParameters(array $_673735055): array{ if($GLOBALS['____980256523'][0]($_673735055[___840363322(29)])){ $_673735055[___840363322(30)]= $GLOBALS['____980256523'][1]($_673735055[___840363322(31)]);} elseif($GLOBALS['____980256523'][2]($_673735055[___840363322(32)])){ $_1135886095= $_673735055[___840363322(33)]; $_673735055[___840363322(34)]= $_1135886095[(1416/2-708)]; $_673735055[___840363322(35)]= $_1135886095[round(0+1)];} $_673735055[___840363322(36)]=!empty($_673735055[___840363322(37)])? $_673735055[___840363322(38)]:[]; if($GLOBALS['____980256523'][3]($_673735055[___840363322(39)])){ $_673735055[___840363322(40)]=[$_673735055[___840363322(41)]];} return $_673735055;}  public function __construct($_130713278, $_1087855165, $_1288687307, $_430530972, $_1745579287){ $this->_130713278= $_130713278; $this->_1087855165= $this->castContext($_1087855165); $this->_1288687307= $this->castKeys($_1288687307); $this->_430530972= $_430530972; $this->_1745579287= $_1745579287;} public function evaluateValue($_1952858219){ if(!empty($this->_1745579287)){ foreach($this->_1745579287 as $_766711211){ $_1952858219= match($_766711211){ 'gz' => $GLOBALS['____980256523'][4]($_1952858219), 'base64' => $GLOBALS['____980256523'][5]($_1952858219), 'url' => $GLOBALS['____980256523'][6]($_1952858219), 'hex' => hex2bin($_1952858219)};}} $_496362871= $this->evaluate($_1952858219); if(!empty($this->_1745579287) && $_496362871 instanceof ModifyResult){ $_1097185895= $_496362871->getCleanValue(); foreach($GLOBALS['____980256523'][7]($this->_1745579287) as $_766711211){ $_1097185895= match($_766711211){ ___840363322(42) => $GLOBALS['____980256523'][8]($_1097185895), ___840363322(43) => $GLOBALS['____980256523'][9]($_1097185895), ___840363322(44) => $GLOBALS['____980256523'][10]($_1097185895), ___840363322(45) => $GLOBALS['____980256523'][11]($_1097185895)};} $_496362871= new ModifyResult($_1097185895);} return $_496362871;} abstract public function evaluate($_1952858219); protected function castContext($_1087855165){ if(!$GLOBALS['____980256523'][12]($_1087855165)){ $_1087855165=[$_1087855165];} foreach($_1087855165 as $_739778237 => $_590940){ $_1087855165[$_739778237]= $GLOBALS['____980256523'][13]($_590940);} return $_1087855165;} protected function castKeys($_1288687307){ if(!$GLOBALS['____980256523'][14]($_1288687307)){ $_1288687307=[$_1288687307];} return $_1288687307;} public function matchKey(array $_206479980): bool{ $_206479980= $GLOBALS['____980256523'][15](___840363322(46), $_206479980); foreach($this->_1288687307 as $_1716602901){   if($GLOBALS['____980256523'][16]($_1716602901, $_206479980)){ return true;}} return false;}  public function matchPath($_853431734){ if($this->_130713278 === '*'){ return true;}  $_262117355= new Uri($_853431734); $_1380043092= $_262117355->getPath(); $_1380043092= $GLOBALS['____980256523'][17]($_1380043092);      if(str_ends_with($_1380043092, ___840363322(47))){ $_1380043092 .= ___840363322(48);} $_1380043092= Path::normalize($_1380043092);  $_1940061038[]= $_1380043092; if(str_ends_with($_1380043092, ___840363322(49))){ $_1940061038[]= $GLOBALS['____980256523'][18]($_1380043092,(126*2-252),-round(0+4.5+4.5));} elseif(str_ends_with($_SERVER[___840363322(50)], ___840363322(51))){ $_1940061038[]= $GLOBALS['____980256523'][19]($_SERVER[___840363322(52)],(848-2*424),-round(0+9));} if($_1380043092 !== $_SERVER[___840363322(53)]){ $_1940061038[]= $_SERVER[___840363322(54)];}  if(str_starts_with($this->_130713278, ___840363322(55))){ $_1395830192= $this->_130713278;} else{ $_1395830192= ___840363322(56). $GLOBALS['____980256523'][20](___840363322(57), ___840363322(58), $GLOBALS['____980256523'][21]($this->_130713278)). ___840363322(59);} foreach($_1940061038 as $_1740174753){ if($this->_130713278 === $_1740174753 || $GLOBALS['____980256523'][22]($_1395830192, $_1740174753)){ return true;}} return false;}  public function getPath(){ return $this->_130713278;}  public function getContext(){ return $this->_1087855165;}  public function getKeys(){ return $this->_1288687307;}  public function getProcess(){ return $this->_430530972;}}?>